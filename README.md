# 🎲 moda 幸運抽獎工具

一個具有 **3D 卡牌雨動畫效果** 的現代化抽獎應用程式，融合專業品牌設計與極致使用者體驗。

## 🚀 線上體驗
**Demo：** https://iim0663418.github.io/lucky_draw_tool/

## ✨ 特色亮點

### 🎨 **3D 視覺體驗**
- **3D 卡牌雨動畫**：使用 Three.js 引擎打造震撼的 3D 卡牌飛舞效果
- **CSS3D + WebGL 雙重渲染**：結合高效能 WebGL 與超清晰 CSS3D 文字渲染
- **品牌 Logo 設計**：卡牌背面展示精美的 moda 品牌識別
- **主題自適應**：支援日間/夜間模式，配色自動調整

### 🎯 **核心功能**
- **智慧抽獎算法**：基於 SHA-256 的可重現抽獎結果
- **多人同時抽獎**：支援同時抽出多位中獎者
- **重複中獎控制**：可選擇是否允許重複中獎
- **歷史記錄管理**：完整的抽獎歷史與分頁瀏覽
- **即時剩餘名單**：動態顯示尚未中獎的參與者

### 💫 **使用者體驗**
- **沉浸式倒數**：全螢幕倒數動畫營造期待感
- **慶祝動畫**：Canvas Confetti 爆炸效果
- **自動滾動**：智慧導航至中獎結果
- **響應式設計**：完美適配各種螢幕尺寸

## 🛠️ 技術架構

### 前端技術棧
- **3D 引擎**：Three.js (WebGL + CSS3DRenderer)
- **動畫系統**：TWEEN.js 補間動畫
- **UI 框架**：Bootstrap 5 響應式設計
- **特效庫**：Canvas Confetti 慶祝動畫
- **現代 CSS**：CSS Custom Properties + CSS Grid

### 核心特性
- **超高品質渲染**：4K 材質 + 各向異性過濾
- **記憶體優化**：智慧資源管理與清理
- **效能優化**：requestAnimationFrame + 硬體加速
- **跨瀏覽器相容**：支援所有現代瀏覽器

## 📁 專案結構

```
lucky_draw_tool/
├── index.html          # 主頁面
├── css/
│   └── style.css       # 主題樣式與動畫
├── js/
│   └── script.js       # 3D 引擎與核心邏輯
└── README.md          # 專案說明
```

## 🎮 使用說明

### 基本操作
1. **設定參與者**：在文字框中每行輸入一位參與者姓名
2. **設定獎項**：輸入抽獎品項名稱
3. **配置參數**：
   - 得獎人數（預設 1 人）
   - 亂數種子（可選，用於結果重現）
   - 重複中獎設定
4. **開始抽獎**：點擊「開始抽獎」享受 3D 動畫體驗

### 進階功能
- **歷史記錄篩選**：依品項快速查找過往抽獎
- **主題切換**：右下角按鈕切換日/夜間模式
- **結果重現**：使用相同種子可重現抽獎結果

## 🔧 部署與安裝

### GitHub Pages 部署
1. Fork 此專案到您的 GitHub 帳號
2. 在 Settings > Pages 中選擇 `main` 分支
3. 等待部署完成，訪問 `https://username.github.io/lucky_draw_tool/`

### 本地開發
```bash
git clone https://github.com/iim0663418/lucky_draw_tool.git
cd lucky_draw_tool
# 使用任何 HTTP 伺服器，例如：
python -m http.server 8000
# 或
npx serve .
```

## ⚙️ 自訂設定

### 修改顯示設定
```javascript
// js/script.js
const PAGE_SIZE = 5;           // 歷史記錄每頁顯示數量
const MAX_HISTORY = 10;        // 最大歷史記錄保存數量
```

### 調整動畫參數
```javascript
// 卡牌動畫時間設定
const ANIMATION_DURATION = 1500;  // 動畫持續時間
const CARD_DELAY = 200;           // 卡牌間隔時間
```

## 🌟 最新更新 (v3.0)

### 🎭 **品牌視覺升級**
- **全新卡牌設計**：雙面卡牌，正面顯示中獎者，背面展示 moda Logo
- **專業配色方案**：
  - 日間模式：純淨白底 + 經典綠色強調
  - 夜間模式：深邃黑底 (#0d1117) + 鮮明綠色 (#00d260)
- **品牌元素整合**：統一的視覺語言與設計系統

### 🚀 **技術革新**
- **混合渲染技術**：CSS3D 負責文字清晰度，WebGL 負責 3D 效果
- **智慧佈局算法**：自動計算最佳卡牌排列與縮放比例
- **效能優化**：超採樣 + Mipmap + 各向異性過濾技術
- **記憶體管理**：完善的資源生命週期管理

### 🎨 **使用體驗提升**
- **沉浸式 3D 效果**：卡牌從背景飛出，翻轉展示中獎結果
- **流暢動畫序列**：三階段動畫（出現 → 飛舞 → 定位）
- **視覺反饋增強**：漸層背景、光暈效果、陰影細節
- **主題無縫切換**：即時響應系統偏好設定

## 🤝 貢獻指南

歡迎提交 Issue 和 Pull Request！

### 開發環境
- 支援現代瀏覽器（Chrome 90+、Firefox 88+、Safari 14+）
- 需要 WebGL 與 CSS3D 支援
- 建議使用支援 ES6+ 的開發環境

### 提交規範
- 遵循 Conventional Commits 規範
- 包含適當的測試與文件更新
- 確保跨瀏覽器相容性

## 📄 授權條款

本專案採用 [Apache-2.0 License](LICENSE)，允許自由使用、修改與再散布。

## 🙏 特別感謝

- [PDIS 抽籤工具](https://shuffler.pdis.tw) - 核心演算法靈感來源
- [Three.js](https://threejs.org/) - 3D 渲染引擎
- [Bootstrap](https://getbootstrap.com/) - UI 框架支援

---

## 1. **專案概述**
本專案為一個基於現代 Web 技術的 3D 抽獎應用程式，結合 moda 品牌設計理念，提供沉浸式的抽獎體驗。透過 Three.js 3D 引擎、CSS3D 渲染技術和專業視覺設計，將傳統抽獎提升為視覺盛宴。

2. **功能特性:**

   * 支援「輸入參與者名單」後每行一位的文字框，用於多筆名單匯入；
   * 可設定「抽獎品項」並顯示於中獎紀錄；
   * 使用者可輸入自訂「亂數種子」或留空以系統時間作為種子，確保結果可重現；
   * 可指定「得獎人數」，若未勾選「允許重複中獎」，則中獎者會從名單移除；
   * 顯示「剩餘參與者清單」，讓使用者即時查看尚未中獎的名單；
   * 中獎時自動顯示「3…2…1 倒數動畫」與《Canvas Confetti》慶祝效果；
   * 將每次抽獎結果（包含品項、時間、種子、得獎者與允許重複狀態）儲存在《localStorage》，並在「歷史紀錄」區塊以「分頁」方式呈現；
   * 可在「歷史紀錄」區塊使用下拉選單進行「品項篩選」，並支援「清除全部紀錄」功能；
   * 前端介面使用《Bootstrap 5》實現響應式佈局與按鈕樣式，適應桌面與行動裝置。
   * 本專案沿襲 https://shuffler.pdis.tw 精神，重視可重現性，相同「抽取母體」及「亂數種子」的情況下，必須有相同的「抽獎結果」。

3. **檔案結構:**

   * `index.html`：主頁面，包含整體佈局與必要連結；
   * `css/style.css`：自訂樣式檔，涵蓋《倒數動畫》、《中獎卡片動畫》、《剩餘名單淡入效果》與版面配置；
   * `js/script.js`：前端邏輯檔，實現「亂數洗牌」、「倒數動畫」、「歷史紀錄分頁篩選」、「剩餘參與者渲染」等核心功能；
   * 其他資源皆引用 CDN，例如《Bootstrap 5》與《Canvas Confetti》函式庫。

4. **環境需求:**

   * 支援現代瀏覽器（Chrome、Firefox、Edge、Safari 等），必須啟用《JavaScript》與《Web Crypto API》；
   * 由於使用《localStorage》儲存歷史紀錄，需要使用者的瀏覽器允許本地儲存；
   * 本專案僅為靜態網站，不需伺服器端運算，可直接部署於「GitHub Pages」或任何靜態服務。

5. **安裝與部署:**

   * 於本機建立資料夾並將專案檔案放置於根目錄；
   * 若要在《GitHub Pages》上部署：

     1. 建立新的 Git 儲存庫（如 `username.github.io`）並切換至 `gh-pages` 分支；
     2. 將 `index.html`、`css/style.css`、`js/script.js` 推送至該分支根目錄；
     3. 於儲存庫「Settings → Pages」中選擇 `gh-pages` 分支與「/ (root)」資料夾作為來源；
     4. 等待數分鐘，訪問 `https://username.github.io/` 即可看到抽獎小程式；
   * 若使用其他靜態主機服務（如 Netlify、Vercel 等），只要將整個資料夾上傳並指向 `index.html` 即可。

6. **使用說明:**

   * 在「參與者清單」文字框中，每行輸入一個參加者姓名；
   * 在「抽獎品項」欄位輸入要抽出的禮品名稱，若留空顯示為「未命名品項」；
   * 可選擇「亂數種子」（如 `123456` 或 `luckyday2024`），若留空則由系統自動以當前時間作為種子；
   * 「得獎人數」預設為 5，可自行修改為所需數量；
   * 勾選「允許重複中獎」後，同一位參與者可重複中獎，否則每位中獎者在中獎後會從名單移除；
   * 按下「🎲 開始抽獎！」後，畫面中央會顯示「倒數 3…2…1」與《Canvas Confetti》動畫，接著顯示每位中獎者姓名卡片；
   * 如未勾選「允許重複中獎」，可在「剩餘參與者清單」區塊查看尚未中獎名單；
   * 每次抽獎結果會存於「歷史紀錄」區塊，可透過上方「品項篩選」與「分頁」功能快速查詢過往紀錄；
   * 若要清除所有歷史紀錄，點擊「清除全部紀錄」按鈕並確認即可。

7. **自訂與參數:**

   * 如需修改「單頁歷史紀錄顯示筆數」，可在 `js/script.js` 中調整 `PAGE_SIZE` 常數值；
   * 若想更改歷史紀錄保留筆數（預設最多 10 筆），可在 `js/script.js` 中修改 `historyList.splice(10)` 的數字；
   * 若要增加其他欄位（例如「抽獎地點」或「備註」），請在 `index.html` 中新增相應輸入欄位，並在 `script.js` 的 `newRecord` 物件中加入對應屬性；
   * 可替換《Bootstrap 5》與《Canvas Confetti》CDN 為本地檔案，請下載相應資源並修改 `index.html` 中的 `<link>`／`<script>` 標籤。

8. **注意事項:**

   * 本專案為前端純靜態程式，請勿放置伺服器端程式（如 Node.js、PHP），否則無法透過《GitHub Pages》正常顯示；
   * 若瀏覽器不支援《Web Crypto API》，亂數洗牌邏輯將無法正常執行，建議使用最新版本的 Chrome 或 Firefox；
   * 「允許重複中獎」與「剩餘參與者」功能須在使用者輸入名單後點擊一次抽獎，才能正確顯示；
   * 若「歷史紀錄分頁」無法顯示，請先確認 `localStorage` 中是否已有 `drawHistory` 記錄；
   * 若欲在 HTTPS 網域部署，請確保《Canvas Confetti》CDN 與《Bootstrap 5》CDN 皆可透過 HTTPS 存取。

9. **授權條款:**
   本專案採用【Apache-2.0 License】，詳細內容請參考 `LICENSE` 檔案，允許任何人自由使用、修改與再散布，惟須保留原始版權與授權聲明。

10. **設計變更與改進**

    本次更新主要引入了「全頁倒數遮罩」與「自動滾動」功能，顯著提升了使用者體驗與視覺效果。

    *   **全頁倒數遮罩：**
        *   **舊設計：** 倒數動畫可能直接在頁面某個區域顯示，缺乏全域性的視覺焦點。
        *   **新設計：** 引入了覆蓋整個頁面的倒數遮罩（`#overlay`），並帶有半透明模糊背景（`.blur-bg`），確保倒數過程成為視覺中心，提升抽獎的儀式感與期待感。倒數數字（`.countdown-number`）具有獨立的淡入淡出動畫，且遮罩在倒數結束後會平滑淡出。

    *   **自動滾動至中獎名單：**
        *   **舊設計：** 使用者可能需要手動滾動頁面才能看到中獎結果，尤其是在長頁面或行動裝置上。
        *   **新設計：** 在倒數結束並中獎卡片渲染完成後，頁面會自動平滑滾動至「中獎名單」區塊（`#winnersContainer`）的頂端，讓使用者無需手動操作即可立即看到結果，提升操作流暢性。

    *   **程式碼結構調整：**
        *   相關的 HTML 結構（`index.html`）、CSS 樣式（`css/style.css`）和 JavaScript 邏輯（`js/script.js`）已進行相應的增補與調整，以支援上述新功能。
        *   `showCountdownOverlay()` 函數負責控制倒數動畫與遮罩顯示隱藏。
        *   `scrollToWinners()` 函數負責實現自動滾動。
        *   `drawButton` 的點擊事件邏輯已更新，以整合倒數遮罩的顯示與自動滾動的觸發。

    這些改進旨在提供更沉浸、更便捷的抽獎體驗。
